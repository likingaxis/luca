---
{"dg-publish":true,"permalink":"/anno-2/sistemi-operativi/codici-in-c/esercizi/2-processi-generati-p1-e-p2/"}
---

![Pasted image 20250102120344.png](/img/user/ANNO%202/SISTEMI%20OPERATIVI/fotosop/Pasted%20image%2020250102120344.png)

```c
#include <stdio.h>

#include <stdlib.h>

#include <unistd.h>

#include <signal.h>

#include <sys/types.h>

int main()

{

  

    int fd [2];

    pipe(fd); //creo  pipe

    pid_t p1, p2; // inizializzo i 2 processi figli

    int tmp1;  // variabile che uso per i numeri

    p1 = fork(); // creo processo 1

    if(p1==0) // il figlio vedrà se stesso come pid 0

    {

        close(fd[0]);

        while(1)

        {

            tmp1=rand()%101;

            if(tmp1%2==1)

            {

                fflush(stdout);

                printf("%d\nsono il p1 \n",tmp1);

                write(fd[1],&tmp1,sizeof(int));

                sleep(1);

            }

        }    

    }

     if (p1 > 0) // il padre vedrà il p1 come un processo con pid >0

        {

        p2 = fork();

        if(p2==0)

        {

            close(fd[0]);

            while(1)

            {

             tmp1=rand()%101;

             if(tmp1%2==0)

                {

                 fflush(stdout);

                 printf("%d\nsono il p2 \n",tmp1);

                 write(fd[1],&tmp1,sizeof(int));

                 sleep(1);

                }

            }    

        }

     }

    int num1,num2;

    if(p1>0 && p2>0)

    {

        while(1)

        {

            close(fd[1]);

            read(fd[0],&num1,sizeof(int));

            printf("primo processo %d \n",num1);

            read(fd[0],&num2,sizeof(int));

            printf("secondo processo %d \n",num2);

            if((num1+num2)>190)

            {

                fflush(stdout);

                printf("\nsono il padre e ho trovato %d sommando i numeri %d, %d\n",num1+num2,num1,num2);

                kill(p1,SIGTERM);

                kill(p2,SIGTERM);

                break;

            }

  

            sleep(1);

        }

    }

     close(fd[0]);

     return 0;

}
```
