---
{"dg-publish":true,"permalink":"/anno-2/sistemi-operativi/codici-in-c/esercizi/5-processi-moltiplicano-matrici/"}
---

>[!tip] consegna
> Scrivere un programma che esegue la moltiplicazione tra matrici 3x3 usando la programmazione parallela:
> 
> - Il primo processo figlio computa la prima colonna.
> - Il secondo processo figlio computa la seconda colonna.
> - Il processo padre computa la terza colonna, riceve dai figli i due vettori colonna computati, compone la matrice finale e la stampa.
```c
#include<stdio.h>
#include<stdlib.h>
#include<unistd.h>
#include<fcntl.h>
void molt(int m1[3][3],int m2[3][3],int r[3],int index)
{
    int tmp=0;
    for(int i=0;i<3;i++)
    {
        for(int j=0;j<3;j++){
            tmp+=m1[i][j]*m2[j][index];//rappresentiamo riga poi colonna
        }

        r[i]=tmp;
        tmp=0;
    }
}
int main(int argc, char** argv)
{
    int m1[3][3]=
    {
        {9,8,18},
        {3,5,15},
        {3,1,27}
    };
    int m2[3][3]=
    {
        {26,6,3},
        {3,6,5},
        {2,4,25}
    };
pid_t p1,p2;
int fd[2];
pipe(fd);
p1=fork();
if (p1==-1) exit(1);
if(p1==0)
{
    close(fd[0]);
    int r[3];
    molt(m1,m2,r,0);
    write(fd[1],&r,sizeof(r));
    exit(0);
}
p2=fork();
if(p2==-1) exit(1);
if(p2==0)
{
    close(fd[0]);
    int r[3];
    molt(m1,m2,r,1);
    write(fd[1],&r,sizeof(r));
    exit(0);
}
if(p1>0 && p2>0)
{
    close(fd[1]);
    int r[3],r1[3],r2[3];
    molt(m1,m2,r,2);
    read(fd[0],&r1,sizeof(r1));
    read(fd[0],&r2,sizeof(r2));
    int result[3][3];
    for(int i=0;i<3;i++)
    {
        result[0][i]=r1[i];
        result[1][i]=r2[i];
        result[2][i]=r[i];
    }
    for(int i=0;i<3;i++)
    {
        printf("|colonna %d \n",i+1);
        for(int j=0;j<3;j++)
        {
             printf("%d \n",result[i][j]);
        }
        printf("------ \n");

    }


}
 return 0;
}
```